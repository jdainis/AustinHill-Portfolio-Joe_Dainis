---
# Data Analysis Introduction Austin Hill
---

# Installing package

# In R Console type in Install.package ("dslabs") DO NOT RUN IN QUARTO CAUSES ERROR WHEN RENDERING.

# load dslabs package

```{r}
library("dslabs")
```

# Taking a look at data

```{r}
str(gapminder)
#Summary of data
summary(gapminder)
# determine the type of object gapminder is
class(gapminder)
```

# Install tidyverse package

Install tidyverse in R console. Not directly into Quarto.

# Adding the dplyr that is part of tidyverse

```{r}
library (dplyr)
```

# This code creates a new dataset called africadata that contains all rows from gapminder where the continent is Africa, keeping all columns.

```{r}
africadata <- gapminder %>%
  filter(continent == "Africa")
```

# To test if previous code worked

```{r}
# look at data
str(africadata)
#Summary of data
summary(africadata)
```

# To create two new objects/variables that contain infant_mortality and life_expectancy and one that contains only population and life_expectancy from africa data.

```{r}
# Only infant_mortality and life_expectancy
Africa_infant_life <- africadata %>% select(infant_mortality, life_expectancy)
# Only population and life_expectancy
Africa_pop_life <- africadata %>% select(population, life_expectancy)
```

# To test if previous code worked

```{r}
# look at data
str(Africa_infant_life)
str(Africa_pop_life)
```

```{r}
#Summary of data
summary(Africa_infant_life)
```

```{r}
#Summary of data
summary(Africa_pop_life)
```

# Loading ggplot2 for plotting

```{r}
library (ggplot2)
```

# Infant Mortality vs life Expectancy plot

```{r}
ggplot(Africa_infant_life, aes(x = infant_mortality, y = life_expectancy)) +
  geom_point(color = "blue", size = 2) +
  labs(
    x = "Infant Mortality",
    y = "Life Expectancy",
    title = "Life Expectancy vs Infant Mortality"
  ) +
  theme_minimal()
```

# Life expectancy vs population (log-scaled x-axis) plot

```{r}
ggplot(Africa_pop_life, aes(x = population, y = life_expectancy)) +
  geom_point(color = "darkgreen", size = 2) +
  scale_x_log10() +  # log-scale for x-axis
  labs(
    x = "Population (log scale)",
    y = "Life Expectancy",
    title = "Life Expectancy vs Population"
  ) +
  theme_minimal()
```

# The plot life expectancy vs population that has multiple overlapping sets seems to be from multiple differnt years of data collection.

# Get the unique years with missing infant_mortality data

```{r}
Africainfant_missing_years <- africadata %>%
  filter(is.na(infant_mortality)) %>%  # keep rows with missing infant_mortality
  distinct(year) %>%                    # get unique years
  arrange(year)                         #sort the years

Africainfant_missing_years
```

# Extracting 2000's data from africadata.

```{r}
africa_2000 <- africadata %>%
  filter(year == 2000)
```

# Checking africa_2000

```{r}
str(africa_2000)
summary(africa_2000)
```

# plot for africa 2000 life expectancy vs population

```{r}
ggplot(africa_2000, aes(x = population, y = life_expectancy)) +
  geom_point(color = "darkgreen", size = 2) +
  scale_x_log10() +  # log-scale for x-axis
  labs(
    x = "Population (log scale)",
    y = "Life Expectancy",
    title = "Life Expectancy vs Population"
  ) +
  theme_minimal()
```

# plot for africa 2000 Infant Mortality vs life Expectancy

```{r}
ggplot(africa_2000, aes(x = infant_mortality, y = life_expectancy)) +
  geom_point(color = "blue", size = 2) +
  labs(
    x = "Infant Mortality",
    y = "Life Expectancy",
    title = "Life Expectancy vs Infant Mortality"
  ) +
  theme_minimal()
```

# Running linear regression on life expectancy and infant mortality plot

```{r}
# Fit a linear model: life_expectancy ~ infant_mortality
fit1 <- lm(life_expectancy ~ infant_mortality, data = africa_2000)

# Print a summary of the model
summary(fit1)
```

# This linear regression shows that there is a strong negative relationship between infant mortality and life expectancy among African countries in 2000.Higher infant mortality tend to have lower life expectancy, and this relationship is statistically significant.

# Running linear regression on life expectancy vs population plot

```{r}
# Fit a linear model: life_expectancy ~ population
fit2 <- lm(life_expectancy ~ population, data = africa_2000)

# Print a summary of the model
summary(fit2)
```

# Unlike infant mortality, population size is not a good predictor of life expectancy for African countries in 2000. Any apparent trend is likely just random variation.

# AI was used to help with coding I was less familar with.

# This section below was contributed by Joe Dainis! Hi
```{r}
#Install and download dslabs package
#install.packages("dslabs")
library("dslabs")

#See overview of mouse weights data
str(mice_weights)

#Get summary of the mouse weights data
summary(mice_weights)

#Install and load dplyr package
#install.packages("dplyr")
library("dplyr")

#Assign female mice to femalemice and then overview their data
femalemice = subset(mice_weights, sex == "F")
str(femalemice)
summary(femalemice)

#Assign male mice to malemice and then overview their data
malemice = subset(mice_weights, sex == "M")
str(malemice)
summary(malemice)

#Select Diet and percent_fat for male and female subset groups
femaledietfat = select(femalemice, c('percent_fat', 'diet', 'body_weight'))
maledietfat = select(malemice, c('percent_fat', 'diet', 'body_weight'))

#See overview and summarize percent fat and diet for male versus female mice
str(femaledietfat)
summary(femaledietfat)
str(maledietfat)
summary(maledietfat)

#Make a plot comparing percent fat in the different diets for male or female mice
##Install ggplot2 to make plots
#install.packages("ggplot2")
library(ggplot2)

#Generate plot for female mice looking at diet influence on body weight
ggplot(data = femaledietfat, aes(x = diet, y = body_weight, color = diet)) + geom_violin() + stat_summary(fun.y=mean, geom="point", color="pink", size=4) + labs(title="Influence of Diet on Body Weight in Female Outbred Mice", x = "mouse diet", y = "body weight at 19 weeks of age")

#Generate plot for male mice looking at diet influence on body weight
ggplot(data = maledietfat, aes(x = diet, y = body_weight, color = diet)) + geom_violin() + stat_summary(fun.y=mean, geom="point", color="blue", size=4) + labs(title="Influence of Diet on Body Weight in Male Outbred Mice", x = "mouse diet", y = "body weight at 19 weeks of age")

#Generate plot for female mice looking at diet influence on fat percent
ggplot(data = femaledietfat, aes(x = diet, y = percent_fat, color = diet)) + geom_violin() + stat_summary(fun.y=mean, geom="point", color="pink", size=4) + labs(title="Influence of Diet on Fat Percentage in Female Outbred Mice", x = "mouse diet", y = "percent fat")

#Generate plot for male mice looking at diet influence on fat percent
ggplot(data = maledietfat, aes(x = diet, y = percent_fat, color = diet)) + geom_violin() + stat_summary(fun.y=mean, geom="point", color="blue", size=4) + labs(title="Influence of Diet on Fat Percentage in Male Outbred Mice", x = "mouse diet", y = "percent fat")

#Fit a logistic model for diet as a predictor of body weight and fat percentage
##Convert rank to a factor for the numeric diet for female and male
femaledietfat$diet <- factor(femaledietfat$diet)
femaledietfat$diet <- as.numeric(femaledietfat$diet)
femaledietfat <- femaledietfat %>%
  mutate(binarydiet = diet - 1)

maledietfat$diet <- factor(maledietfat$diet)
maledietfat$diet <- as.numeric(maledietfat$diet)
maledietfat <- maledietfat %>%
  mutate(binarydiet = diet - 1)
##Fit the logistic regression model
mylogitfembody <- glm(binarydiet ~ body_weight, data=femaledietfat, family = "binomial")
summary(mylogitfembody)

mylogitfemfat <- glm(binarydiet ~ percent_fat, data=femaledietfat, family = "binomial")
summary(mylogitfemfat)

mylogitmalebody <- glm(binarydiet ~ body_weight, data=maledietfat, family = "binomial")
summary(mylogitmalebody)

mylogitmalefat <- glm(binarydiet ~ percent_fat, data=maledietfat, family = "binomial")
summary(mylogitmalefat)

#In summary, we found that diet appears to have an influence in both male and female mice, with a high fat diet leading to a higher body weight at 19 weeks of age and a higher fat percentage. We also found that body weight and fat percentage of the mice can be a predictor of the diet that the mice was on.
```